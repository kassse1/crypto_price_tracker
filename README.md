–î–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π backend-—Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–±–æ—Ä–∞ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è index price –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç —Å –±–∏—Ä–∂–∏ Deribit.

–°–µ—Ä–≤–∏—Å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—É—â–∏–µ —Ü–µ–Ω—ã btc_usd –∏ eth_usd —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π Deribit API, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö PostgreSQL –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç HTTP API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ü–µ–Ω—ã –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω.

---

## üöÄ Features

- Periodic price fetching (every minute)
- Persistent price history storage
- REST API (GET only)
- Fault-tolerant external API handling (retry & timeout)
- Unit tests for business logic
- Dockerized environment

---

## üõ† Tech Stack

- **Python 3.11**
- **FastAPI**
- **PostgreSQL**
- **Celery + Redis**
- **aiohttp**
- **SQLAlchemy**
- **Docker / Docker Compose**
- **pytest**

---

## üèó Architecture

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑–¥–µ–ª—ë–Ω –Ω–∞ —Å–ª–æ–∏:

- **API layer** ‚Äî FastAPI endpoints
- **Service layer** ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å —Ü–µ–Ω–∞–º–∏
- **Client layer** ‚Äî HTTP-–∫–ª–∏–µ–Ω—Ç Deribit
- **DB layer** ‚Äî –º–æ–¥–µ–ª–∏ –∏ —Å–µ—Å—Å–∏–∏ –ë–î
- **Background workers** ‚Äî Celery tasks –¥–ª—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–≥–æ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

–¢–∞–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —É–ø—Ä–æ—â–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É –∫–æ–¥–∞.

---

## üì¶ Installation & Run

### 1Ô∏è‚É£ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

```bash
docker-compose up --build
–ë—É–¥—É—Ç –∑–∞–ø—É—â–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã:

API (FastAPI)

Celery worker + Celery beat

PostgreSQL

Redis

üîé How to verify the application works
1Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–≥–æ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
–ü–æ–¥–æ–∂–¥–∏—Ç–µ 1‚Äì2 –º–∏–Ω—É—Ç—ã –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞.

–í –ª–æ–≥–∞—Ö Celery –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:

arduino
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
Task app.tasks.fetch_prices.fetch_prices succeeded
2Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
docker exec -it crypto_price_tracker-db-1 psql -U postgres
sql
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
SELECT * FROM prices;
–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –∑–∞–ø–∏—Å–∏ –¥–ª—è btc_usd –∏ eth_usd.

3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ API
Swagger UI:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
http://localhost:8000/docs
–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –≤–∞–ª—é—Ç–µ
bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
curl "http://localhost:8000/prices?ticker=btc_usd"
–ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é —Ü–µ–Ω—É
bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
curl "http://localhost:8000/prices/latest?ticker=btc_usd"
–ü–æ–ª—É—á–∏—Ç—å —Ü–µ–Ω—ã –∑–∞ –ø–µ—Ä–∏–æ–¥
bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
curl "http://localhost:8000/prices/by-date?ticker=btc_usd&start=1700000000&end=1800000000"
üß™ Run tests
–¢–µ—Å—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
docker exec -it crypto_price_tracker-api-1 python -m pytest
üß† Design Decisions
–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è public endpoints Deribit API, —Ç–∞–∫ –∫–∞–∫ –ø–æ–ª—É—á–µ–Ω–∏–µ index price –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–∞–∫ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥ (append-only), –±–µ–∑ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π.

–ü–æ—Å–ª–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω—è—è –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å (–ø–æ id), —á—Ç–æ –Ω–∞–¥—ë–∂–Ω–µ–µ, —á–µ–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ timestamp.

–í–Ω–µ—à–Ω–∏–π API –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª–µ–Ω, –ø–æ—ç—Ç–æ–º—É —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã retry –∏ timeout.

Unit-—Ç–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç —Å–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π, –≥–¥–µ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞.
